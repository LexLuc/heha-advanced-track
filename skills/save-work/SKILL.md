---
name: save-work
description: 保存工作并备份到线上。当用户说"保存工作"、"提交一下"、"阶段性完成"、"存个档"、"备份"、"push"时使用。
---

# 保存工作并备份到线上

帮助用户将当前改动提交到本地仓库，并推送到远端备份。

## 步骤

1. **检查当前分支**：运行 `git branch --show-current`

   - 如果当前在 `main` 分支上，**停下来警告用户**：不应该直接在 main 上提交。列出可用的非 main 分支（`git branch`），询问用户要切换到哪个分支，或者建议用 `/start-work` 先创建一个新分支
   - 如果在自己的工作分支上，继续下一步

2. **查看当前改动**：运行 `git status` 展示给用户看有哪些文件变更了

   - 如果没有任何改动，告诉用户"当前没有需要保存的改动"，结束流程
   - 如果有改动，继续下一步

3. **添加改动**：运行 `git add -A` 将所有改动加入暂存区。如果发现有 `.env`、credentials 等敏感文件，警告用户并排除这些文件

4. **生成提交信息**：运行 `git diff --cached` 查看暂存的改动，为用户生成一条简洁的中文提交信息，格式为：

   ```
   <类型>: <简短描述>
   ```

   类型参考：feat（新功能）、fix（修复）、docs（文档）、refactor（重构）、chore（杂项）

5. **确认并提交**：将生成的提交信息展示给用户确认，然后运行 `git commit`

6. **推送到远端备份**：运行 `git push -u origin <当前分支名>`

7. **确认成功**：运行 `git log --oneline -1` 展示提交记录，告诉用户"工作已保存并备份到线上"
